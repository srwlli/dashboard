---
agent: Claude Sonnet 4.5
date: "2026-01-14"
task: DOCUMENT
subject: OutputViewer
parent_project: coderef-dashboard
category: component
version: 1.0.0
related_files:
  - packages/dashboard/src/components/SessionsHub/SessionMonitoring/OutputViewer.tsx
status: APPROVED
---

# OutputViewer - Resource Sheet

**Category:** UI Component  
**Type:** React Client Component  
**File:** `packages/dashboard/src/components/SessionsHub/SessionMonitoring/OutputViewer.tsx`  
**Created:** 2026-01-14  
**Lines of Code:** ~190  
**Complexity:** Medium

---

**Generated by:** Manual documentation  
**Timestamp:** 2026-01-14  
**Auto-fill Rate:** Manual (comprehensive analysis)

---

## Executive Summary

**Element:** OutputViewer  
**Category:** UI Component  
**Purpose:** Modal component to display agent output files with automatic file type detection, syntax highlighting for JSON, GitHub Flavored Markdown rendering, and plain text display.

**Key Responsibilities:**
- Displaying agent output files in a modal dialog
- Automatic file type detection (JSON, Markdown, Text)
- Syntax highlighting for JSON files
- Markdown rendering with GitHub Flavored Markdown support (tables, autolinks, strikethrough, task lists)
- Plain text display with monospace formatting
- File download functionality
- Loading and empty states

**Not Responsible For:**
- File type detection logic (uses `detectFileType` utility)
- File content fetching (receives content via props)
- Session management (parent component handles)

---

## Architecture Overview

### Dependencies

**Internal:**
- None (standalone modal component)

**External:**
- `react-markdown`: For markdown rendering
- `remark-gfm`: For GitHub Flavored Markdown support (tables, autolinks, strikethrough, task lists)
- `react-syntax-highlighter`: For JSON syntax highlighting
- `lucide-react`: For icons (X, Download, FileText)

### State Management

- `fileType` (`'json' | 'markdown' | 'text'`): Detected file type based on content and filename
- No other local state (receives all data via props)

### Data Flow

1. **Props Change:** `content` or `fileName` updates
2. **Effect Trigger:** `useEffect` calls `detectFileType`
3. **Type Detection:** Checks filename extension or content patterns
4. **Render:**
   - JSON → SyntaxHighlighter with JSON language
   - Markdown → ReactMarkdown with remark-gfm plugin
   - Text → Plain `<pre>` element with monospace styling

---

## Supported Formats

| Type | Detection Method | Renderer |
| :--- | :--- | :--- |
| **JSON** | Filename `.json` or valid JSON parse | `SyntaxHighlighter` (VSCode Dark Plus) with line numbers |
| **Markdown** | Filename `.md` or content markers (`#`, `##`, ` ``` `) | `ReactMarkdown` + `remark-gfm` (supports tables, autolinks, strikethrough, task lists) |
| **Text** | Default fallback | Plain `<pre>` with monospace font |

---

## File Type Detection

The `detectFileType` function uses a two-step process:

1. **Filename Check:** If `fileName` prop is provided:
   - `.json` → `'json'`
   - `.md` → `'markdown'`

2. **Content Analysis:** If filename doesn't match:
   - Try parsing as JSON → `'json'` if successful
   - Check for markdown markers (`# `, `## `, ` ``` `) → `'markdown'` if found
   - Default → `'text'`

---

## UI Features

### Modal Structure

- **Fixed overlay:** Full-screen backdrop with semi-transparent black
- **Centered dialog:** Max width 4xl, max height 90vh
- **Flex layout:** Header, scrollable content, footer

### Header

- **Title:** "Agent Output" with FileText icon
- **Subtitle:** Agent ID and filename
- **Actions:**
  - Download button (Download icon) - Downloads content as file
  - Close button (X icon) - Closes modal

### Content Area

- **Scrollable:** Flex-1 with overflow-y-auto
- **Loading State:** Centered "Loading..." message
- **Empty State:** FileText icon with "No output available" message
- **Content Rendering:** Type-specific renderer (JSON/Markdown/Text)

### Footer

- **File Info:** Type and size in bytes
- **Hint:** "Press ESC to close" (keyboard accessibility)

---

## Integration Points

- **Parent:** `SessionMonitoringContainer` - Opens/closes modal, provides content
- **Data Source:** `getAgentOutput()` API function fetches content
- **State Management:** Parent component manages `outputViewerState` (isOpen, agentId)

---

## Utility Functions

- **`detectFileType(content: string, fileName?: string): 'json' | 'markdown' | 'text'`** - Detects file type from filename extension or content analysis. Returns 'json' if filename ends with `.json` or content parses as valid JSON. Returns 'markdown' if filename ends with `.md` or content contains markdown markers. Otherwise returns 'text'.

- **`downloadContent(content: string, filename: string): void`** - Creates a Blob from content and triggers browser download. Uses URL.createObjectURL and programmatic click on temporary anchor element.

---

## Common Pitfalls

1. **File Type Detection:** Content-based detection may incorrectly identify JSON if content happens to parse as valid JSON but isn't intended to be JSON.
2. **Large Files:** No virtualization for very large files. Large markdown files might lag the DOM.
3. **Markdown Rendering:** Uses same GFM support as FileViewer (tables, autolinks, etc.) for consistency.

---

**Complexity Score:** Medium  
**Modules Used:** modal-dialog, file-type-detection, syntax-highlighting, markdown-rendering
